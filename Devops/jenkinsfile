pipeline{
agent any
tools{
     maven 'maven 3.9.5'
     }
stages{
      stage('Compilar'){
            steps{
                  echo "compilando..." 
                  sh "mvn clean compile"
                 } 

                         }
      stage('Pruebas') {
            steps{
                   echo "Ejecutando pruebas..."
                   sh "mvn test -Dspring.profiles.active=test -Dspring.data.mongodb.uri=mongodb://mongodb:27017/seguridad_test"
                  }
                       }
      stage('Análisis de Código Estático') {
             steps {sh 'mvn sonar:sonar'
                   }
                                           }

      stage('Empaquetar') {
            steps {sh 'mvn package'
                   }
                           }

              post{
                   success{
                         junit "target/surefire-reports/*.xml"  
                         }
                  }
                        } 
     }
         }